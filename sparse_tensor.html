

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SparseTensor &mdash; MinkowskiEngine 0.4.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MinkowskiConvolution" href="convolution.html" />
    <link rel="prev" title="PointNet" href="demo/pointnet.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MinkowskiEngine
          

          
          </a>

          
            
            
              <div class="version">
                0.4.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Minkowski Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse_tensor_network.html">Sparse Tensor Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="terminology.html">Definitions and Terminology</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/sparse_tensor_basic.html">Sparse Tensor Basics</a></li>
</ul>
<p class="caption"><span class="caption-text">Demos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demo/training.html">Training Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/modelnet40_classification.html">ModelNet40 Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/segmentation.html">Semantic Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/sparse_tensor_reconstruction.html">3D Sparsity Pattern Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/interop.html">Working with Pytorch Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/multigpu.html">Multi-GPU Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo/pointnet.html">PointNet</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">SparseTensor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">SparseTensor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="convolution.html">MinkowskiConvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="pooling.html">MinkowskiPooling</a></li>
<li class="toctree-l1"><a class="reference internal" href="broadcast.html">MinkowskiBroadcast</a></li>
<li class="toctree-l1"><a class="reference internal" href="normalization.html">MinkowskiNormalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinearity.html">MinkowskiNonlinearities</a></li>
<li class="toctree-l1"><a class="reference internal" href="pruning.html">MinkowskiPruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="union.html">MinkowskiUnion</a></li>
<li class="toctree-l1"><a class="reference internal" href="coords.html">Coordinate Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utility Functions and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Miscellaneous Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellanea</a></li>
</ul>
<p class="caption"><span class="caption-text">Miscellanea</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Common Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guidelines for Faster Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmark</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MinkowskiEngine</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>SparseTensor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/sparse_tensor.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
            
  <div class="section" id="sparsetensor">
<h1>SparseTensor<a class="headerlink" href="#sparsetensor" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>SparseTensor<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor">
<em class="property">class </em><code class="sig-prename descclassname">MinkowskiEngine.SparseTensor.</code><code class="sig-name descname">SparseTensor</code><span class="sig-paren">(</span><em class="sig-param">feats</em>, <em class="sig-param">coords=None</em>, <em class="sig-param">coords_key=None</em>, <em class="sig-param">coords_manager=None</em>, <em class="sig-param">force_creation=False</em>, <em class="sig-param">allow_duplicate_coords=False</em>, <em class="sig-param">quantization_mode=&lt;SparseTensorQuantizationMode.RANDOM_SUBSAMPLE: 0&gt;</em>, <em class="sig-param">tensor_stride=1</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor" title="Permalink to this definition">¶</a></dt>
<dd><p>A sparse tensor class. Can be accessed via
<a class="reference internal" href="source/MinkowskiEngine.html#module-MinkowskiEngine.SparseTensor" title="MinkowskiEngine.SparseTensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.SparseTensor</span></code></a>.</p>
<p>The <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor" title="MinkowskiEngine.SparseTensor.SparseTensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SparseTensor</span></code></a> class is the basic tensor in MinkowskiEngine. For
the definition of a sparse tensor, please visit <a class="reference external" href="https://stanfordvl.github.io/MinkowskiEngine/terminology.html#sparse-tensor">the terminology page</a>.
We use the COOrdinate (COO) format to save a sparse tensor <a class="reference external" href="http://groups.csail.mit.edu/commit/papers/2016/parker-thesis.pdf">[1]</a>. This
representation is simply a concatenation of coordinates in a matrix
<span class="math notranslate nohighlight">\(C\)</span> and associated features <span class="math notranslate nohighlight">\(F\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{C} = \begin{bmatrix}
b_1    &amp; x_1^1  &amp; x_1^2  &amp; \cdots &amp; x_1^D  \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
b_N    &amp; x_N^1  &amp; x_N^2  &amp; \cdots &amp; x_N^D
\end{bmatrix}, \; \mathbf{F} = \begin{bmatrix}
\mathbf{f}_1^T\\
\vdots\\
\mathbf{f}_N^T
\end{bmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}_i \in \mathcal{Z}^D\)</span> is a <span class="math notranslate nohighlight">\(D\)</span>-dimensional
coordinate and <span class="math notranslate nohighlight">\(b_i \in \mathcal{Z}_+\)</span> denotes the corresponding
batch index. <span class="math notranslate nohighlight">\(N\)</span> is the number of non-zero elements in the sparse
tensor, each with the coordinate <span class="math notranslate nohighlight">\((b_i, x_i^1, x_i^1, \cdots,
x_i^D)\)</span>, and the associated feature <span class="math notranslate nohighlight">\(\mathbf{f}_i\)</span>. Internally, we
handle the batch index as an additional spatial dimension.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before MinkowskiEngine version 0.4, we put the batch indices on the last
column. Thus, direct manipulation of coordinates will be incompatible
with the latest versions. Instead, please use
<a class="reference internal" href="utils.html#MinkowskiEngine.utils.batched_coordinates" title="MinkowskiEngine.utils.batched_coordinates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.utils.batched_coordinates</span></code></a> or
<a class="reference internal" href="utils.html#MinkowskiEngine.utils.sparse_collate" title="MinkowskiEngine.utils.sparse_collate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.utils.sparse_collate</span></code></a> to create batched
coordinates.</p>
<p>Also, to access coordinates or features batch-wise, use the functions
<code class="xref py py-attr docutils literal notranslate"><span class="pre">coordinates_at(batch_index</span> <span class="pre">:</span> <span class="pre">int)</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">features_at(batch_index</span> <span class="pre">:</span> <span class="pre">int)</span></code> of
a sparse tensor. Or to access all batch-wise coordinates and features,
<cite>decomposed_coordinates</cite>, <cite>decomposed_features</cite>,
<cite>decomposed_coordinates_and_features</cite> of a sparse tensor.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span><span class="p">,</span> <span class="n">feats</span> <span class="o">=</span> <span class="n">ME</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">sparse_collate</span><span class="p">([</span><span class="n">coords_batch0</span><span class="p">,</span> <span class="n">coords_batch1</span><span class="p">],</span> <span class="p">[</span><span class="n">feats_batch0</span><span class="p">,</span> <span class="n">feats_batch1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">ME</span><span class="o">.</span><span class="n">SparseTensor</span><span class="p">(</span><span class="n">feats</span><span class="o">=</span><span class="n">feats</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords_batch0</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">coordinates_at</span><span class="p">(</span><span class="n">batch_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feats_batch1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">features_at</span><span class="p">(</span><span class="n">batch_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_of_coords</span><span class="p">,</span> <span class="n">list_of_featurs</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">decomposed_coordinates_and_features</span>
</pre></div>
</div>
</div>
<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">feats</em>, <em class="sig-param">coords=None</em>, <em class="sig-param">coords_key=None</em>, <em class="sig-param">coords_manager=None</em>, <em class="sig-param">force_creation=False</em>, <em class="sig-param">allow_duplicate_coords=False</em>, <em class="sig-param">quantization_mode=&lt;SparseTensorQuantizationMode.RANDOM_SUBSAMPLE: 0&gt;</em>, <em class="sig-param">tensor_stride=1</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Args:</dt><dd><p><a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.feats" title="MinkowskiEngine.SparseTensor.SparseTensor.feats"><code class="xref py py-attr docutils literal notranslate"><span class="pre">feats</span></code></a> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.FloatTensor</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.DoubleTensor</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.cuda.FloatTensor</span></code>, or
<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.cuda.DoubleTensor</span></code>): The features of the sparse
tensor.</p>
<p><a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.coords" title="MinkowskiEngine.SparseTensor.SparseTensor.coords"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code></a> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.IntTensor</span></code>): The coordinates
associated to the features. If not provided, <code class="xref py py-attr docutils literal notranslate"><span class="pre">coords_key</span></code>
must be provided.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords_key</span></code> (<a class="reference internal" href="coords.html#MinkowskiEngine.CoordsKey" title="MinkowskiEngine.CoordsKey"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.CoordsKey</span></code></a>): When the
coordinates are already cached in the MinkowskiEngine, we could
reuse the same coordinates by simply providing the coordinate hash
key. In most case, this process is done automatically. When you
provide a <cite>coords_key</cite>, all other arguments will be be ignored.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords_manager</span></code> (<a class="reference internal" href="coords.html#MinkowskiEngine.CoordsManager" title="MinkowskiEngine.CoordsManager"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.CoordsManager</span></code></a>): The
MinkowskiEngine creates a dynamic computation graph and all
coordinates inside the same computation graph are managed by a
CoordsManager object. If not provided, the MinkowskiEngine will
create a new computation graph. In most cases, this process is
handled automatically and you do not need to use this. When you use
it, make sure you understand what you are doing.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">force_creation</span></code> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">bool</span></code>): Force creation of the
coordinates. This allows generating a new set of coordinates even
when there exists another set of coordinates with the same
tensor stride. This could happen when you manually feed the same
<code class="xref py py-attr docutils literal notranslate"><span class="pre">coords_manager</span></code>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">allow_duplicate_coords</span></code> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">bool</span></code>): Allow duplicate
coordinates when creating the sparse tensor. Internally, it will
generate a new unique set of coordinates and use features of at the
corresponding unique coordinates. In general, setting
<cite>allow_duplicate_coords=True</cite> is not recommended as it could hide
obvious errors in your data loading and preprocessing steps. Please
refer to the quantization and data loading tutorial on <a class="reference external" href="https://stanfordvl.github.io/MinkowskiEngine/demo/training.html">here</a>
for more details.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">quantizatino_mode</span></code>
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.SparseTensorQuantizationMode</span></code>): Defines the
quantization method and how to define features of a sparse tensor.
Please refer to <a class="reference internal" href="source/MinkowskiEngine.html#MinkowskiEngine.SparseTensor.SparseTensorQuantizationMode" title="MinkowskiEngine.SparseTensor.SparseTensorQuantizationMode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SparseTensorQuantizationMode</span></code></a> for details.</p>
<p><a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">list</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.array</span></code>, or <code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor.Tensor</span></code>): The tensor stride
of the current sparse tensor. By default, it is 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.C">
<em class="property">property </em><code class="sig-name descname">C</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.C" title="Permalink to this definition">¶</a></dt>
<dd><p>The alias of <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.coords" title="MinkowskiEngine.SparseTensor.SparseTensor.coords"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.D">
<em class="property">property </em><code class="sig-name descname">D</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.D" title="Permalink to this definition">¶</a></dt>
<dd><p>The spatial dimension of the sparse tensor. This is equal to the number
of columns of <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.C" title="MinkowskiEngine.SparseTensor.SparseTensor.C"><code class="xref py py-attr docutils literal notranslate"><span class="pre">C</span></code></a> minus 1.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.F">
<em class="property">property </em><code class="sig-name descname">F</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.F" title="Permalink to this definition">¶</a></dt>
<dd><p>The alias of <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.feats" title="MinkowskiEngine.SparseTensor.SparseTensor.feats"><code class="xref py py-attr docutils literal notranslate"><span class="pre">feats</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.coordinates_and_features_at">
<code class="sig-name descname">coordinates_and_features_at</code><span class="sig-paren">(</span><em class="sig-param">batch_index</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.coordinates_and_features_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a coordinate and feature matrix at the specified batch index.</p>
<p>Returns a coordinate and feature matrix at the specified <cite>batch_index</cite>.
The coordinate matrix is a torch.IntTensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N
\times D}\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the number of non zero elements in the
specified batch index in <span class="math notranslate nohighlight">\(D\)</span> dimensional space. The feature
matrix is a torch.Tensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N \times N_F}\)</span>
matrix <span class="math notranslate nohighlight">\(N\)</span> is the number of non zero elements in the specified
batch index and <span class="math notranslate nohighlight">\(N_F\)</span> is the number of channels.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.coordinates_at">
<code class="sig-name descname">coordinates_at</code><span class="sig-paren">(</span><em class="sig-param">batch_index</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.coordinates_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coordinates at the specified batch index.</p>
<p>Returns a torch.IntTensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N_i
\times D}\)</span> coordinates at the specified batch index where <span class="math notranslate nohighlight">\(N_i\)</span>
is the number of non zero elements in the <span class="math notranslate nohighlight">\(i\)</span> dimensional space.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.coords">
<em class="property">property </em><code class="sig-name descname">coords</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.coords" title="Permalink to this definition">¶</a></dt>
<dd><p>The coordinates of the current sparse tensor. The coordinates are
represented as a <span class="math notranslate nohighlight">\(N \times (D + 1)\)</span> dimensional matrix where
<span class="math notranslate nohighlight">\(N\)</span> is the number of points in the space and <span class="math notranslate nohighlight">\(D\)</span> is the
dimension of the space (e.g. 3 for 3D, 4 for 3D + Time). Additional
dimension of the column of the matrix C is for batch indices which is
internally treated as an additional spatial dimension to disassociate
different instances in a batch.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.cpu">
<code class="sig-name descname">cpu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.cpu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.decomposed_coordinates">
<em class="property">property </em><code class="sig-name descname">decomposed_coordinates</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.decomposed_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of coordinates per batch.</p>
<p>Returns a list of torch.IntTensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N_i
\times D}\)</span> coordinates per batch where <span class="math notranslate nohighlight">\(N_i\)</span> is the number of non
zero elements in the <span class="math notranslate nohighlight">\(i\)</span> dimensional
space.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.decomposed_coordinates_and_features">
<em class="property">property </em><code class="sig-name descname">decomposed_coordinates_and_features</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.decomposed_coordinates_and_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of coordinates and a list of features per batch.abs</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.decomposed_features">
<em class="property">property </em><code class="sig-name descname">decomposed_features</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.decomposed_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of features per batch.</p>
<p>Returns a list of torch.Tensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N_i
\times N_F}\)</span> features per batch where <span class="math notranslate nohighlight">\(N_i\)</span> is the number of non
zero elements in the <span class="math notranslate nohighlight">\(i\)</span> dimensional
space.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.dense">
<code class="sig-name descname">dense</code><span class="sig-paren">(</span><em class="sig-param">min_coords=None</em>, <em class="sig-param">max_coords=None</em>, <em class="sig-param">contract_coords=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the <a class="reference internal" href="source/MinkowskiEngine.html#module-MinkowskiEngine.SparseTensor" title="MinkowskiEngine.SparseTensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.SparseTensor</span></code></a> to a torch dense
tensor.</p>
<dl>
<dt>Args:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> (torch.IntTensor, optional): The min
coordinates of the output sparse tensor. Must be divisible by the
current <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_coords</span></code> (torch.IntTensor, optional): The max coordinates
of the output sparse tensor (inclusive). Must be divisible by the
current <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">contract_coords</span></code> (bool, optional): Given True, the output
coordinates will be divided by the tensor stride to make features
contiguous.</p>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">spare_tensor</span></code> (torch.sparse.Tensor): the torch sparse tensor
representation of the self in <cite>[Batch Dim, Spatial Dims…, Feature
Dim]</cite>. The coordinate of each feature can be accessed via
<cite>min_coord + tensor_stride * [the coordinate of the dense tensor]</cite>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> (torch.IntTensor): the D-dimensional vector
defining the minimum coordinate of the output sparse tensor. If
<code class="xref py py-attr docutils literal notranslate"><span class="pre">contract_coords</span></code> is True, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> will also
be contracted.</p>
<p><a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a> (torch.IntTensor): the D-dimensional vector
defining the stride between tensor elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.dimension">
<em class="property">property </em><code class="sig-name descname">dimension</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias of attr:<cite>D</cite></p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.double">
<code class="sig-name descname">double</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.double" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.dtype">
<em class="property">property </em><code class="sig-name descname">dtype</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.dtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.feats">
<em class="property">property </em><code class="sig-name descname">feats</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.feats" title="Permalink to this definition">¶</a></dt>
<dd><p>The features of the current sparse tensor. The features are <span class="math notranslate nohighlight">\(N
\times D_F\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the number of points in the space and
<span class="math notranslate nohighlight">\(D_F\)</span> is the dimension of each feature vector. Please refer to
<a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.coords" title="MinkowskiEngine.SparseTensor.SparseTensor.coords"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coords</span></code></a> to access the associated coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.features_at">
<code class="sig-name descname">features_at</code><span class="sig-paren">(</span><em class="sig-param">batch_index</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.features_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a feature matrix at the specified batch index.</p>
<p>Returns a torch.Tensor <span class="math notranslate nohighlight">\(C \in \mathcal{R}^{N
\times N_F}\)</span> feature matrix <span class="math notranslate nohighlight">\(N\)</span> is the number of non
zero elements in the specified batch index and <span class="math notranslate nohighlight">\(N_F\)</span> is the
number of channels.</p>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.float">
<code class="sig-name descname">float</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.float" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.get_device">
<code class="sig-name descname">get_device</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.get_device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.requires_grad">
<em class="property">property </em><code class="sig-name descname">requires_grad</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.requires_grad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.requires_grad_">
<code class="sig-name descname">requires_grad_</code><span class="sig-paren">(</span><em class="sig-param">requires_grad: bool = True</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.requires_grad_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.set_tensor_stride">
<code class="sig-name descname">set_tensor_stride</code><span class="sig-paren">(</span><em class="sig-param">s</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.set_tensor_stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.size">
<code class="sig-name descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">slicing_mode=0</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.slice" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Args:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">X</span></code> (<a class="reference internal" href="source/MinkowskiEngine.html#module-MinkowskiEngine.SparseTensor" title="MinkowskiEngine.SparseTensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.SparseTensor</span></code></a>): a sparse tensor
that discretized the original input.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">slicing_mode</span></code>: For future updates.</p>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">sliced_feats</span></code> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.Tensor</span></code>): the resulting feature
matrix that slices features on the discretized coordinates to the
original continuous coordinates that generated the input X.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># coords, feats from a data loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">))</span>  <span class="c1"># 227742</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinput</span> <span class="o">=</span> <span class="n">ME</span><span class="o">.</span><span class="n">SparseTensor</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">feats</span><span class="o">=</span><span class="n">feats</span><span class="p">,</span> <span class="n">quantization_mode</span><span class="o">=</span><span class="n">SparseTensorQuantizationMode</span><span class="o">.</span><span class="n">UNWEIGHTED_AVERAGE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sinput</span><span class="p">))</span>  <span class="c1"># 161890 quantization results in fewer voxels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">soutput</span> <span class="o">=</span> <span class="n">network</span><span class="p">(</span><span class="n">sinput</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soutput</span><span class="p">))</span>  <span class="c1"># 161890 Output with the same resolution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">soutput</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">sinput</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>  <span class="c1"># regular differentiable pytorch tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>  <span class="c1"># recovers the original ordering and length</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.sparse">
<code class="sig-name descname">sparse</code><span class="sig-paren">(</span><em class="sig-param">min_coords=None</em>, <em class="sig-param">max_coords=None</em>, <em class="sig-param">contract_coords=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the <a class="reference internal" href="source/MinkowskiEngine.html#module-MinkowskiEngine.SparseTensor" title="MinkowskiEngine.SparseTensor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MinkowskiEngine.SparseTensor</span></code></a> to a torch sparse
tensor.</p>
<dl>
<dt>Args:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> (torch.IntTensor, optional): The min
coordinates of the output sparse tensor. Must be divisible by the
current <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">max_coords</span></code> (torch.IntTensor, optional): The max coordinates
of the output sparse tensor (inclusive). Must be divisible by the
current <a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">contract_coords</span></code> (bool, optional): Given True, the output
coordinates will be divided by the tensor stride to make features
contiguous.</p>
</dd>
<dt>Returns:</dt><dd><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">spare_tensor</span></code> (torch.sparse.Tensor): the torch sparse tensor
representation of the self in <cite>[Batch Dim, Spatial Dims…, Feature
Dim]</cite>. The coordinate of each feature can be accessed via
<cite>min_coord + tensor_stride * [the coordinate of the dense tensor]</cite>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> (torch.IntTensor): the D-dimensional vector
defining the minimum coordinate of the output sparse tensor. If
<code class="xref py py-attr docutils literal notranslate"><span class="pre">contract_coords</span></code> is True, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">min_coords</span></code> will also
be contracted.</p>
<p><a class="reference internal" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tensor_stride</span></code></a> (torch.IntTensor): the D-dimensional vector
defining the stride between tensor elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride">
<em class="property">property </em><code class="sig-name descname">tensor_stride</code><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.tensor_stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="MinkowskiEngine.SparseTensor.SparseTensor.to">
<code class="sig-name descname">to</code><span class="sig-paren">(</span><em class="sig-param">device</em><span class="sig-paren">)</span><a class="headerlink" href="#MinkowskiEngine.SparseTensor.SparseTensor.to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
<a href="https://github.com/StanfordVL/MinkowskiEngine">
    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
</a>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43980256-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-43980256-3');
</script>


          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="convolution.html" class="btn btn-neutral float-right" title="MinkowskiConvolution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="demo/pointnet.html" class="btn btn-neutral float-left" title="PointNet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Chris Choy

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>