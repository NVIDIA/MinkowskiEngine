Bootstrap: docker
From: pytorch/pytorch:1.12.0-cuda11.3-cudnn8-devel

%post
        apt-get -y update
        DEBIAN_FRONTEND=noninteractive apt-get install -y tzdata
        apt install -y git ninja-build cmake build-essential libopenblas-dev xterm xauth openssh-server tmux wget mate-desktop-environment-core
        apt-get clean
        rm -rf /var/lib/apt/lists/*

        export TORCH_CUDA_ARCH_LIST="6.0 6.1 6.2 7.0 7.2 7.5 8.0 8.6"
        export TORCH_NVCC_FLAGS="-Xfatbin -compress-all"
        # For faster build, use more jobs.
        MAX_JOBS=4
        git clone --recursive "https://github.com/NVIDIA/MinkowskiEngine"
        cd MinkowskiEngine
        python setup.py install --force_cuda --blas=openblas

%runscript
        python
